// const stationsEx = [
//   {
//     id: 13400001,
//     Brand: "Auchan",
//     name: "AUCHAN",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-24T07:14:12Z",
//           text: "24/10/2023 07:14:12",
//         },
//         available: true,
//         Price: {
//           value: 1.885,
//           currency: "EUR",
//           text: "1.885 €",
//         },
//       },
//       {
//         id: 3,
//         name: "Super Ethanol E85",
//         short_name: "E85",
//         picto: "E85",
//         Update: {
//           value: "2023-10-20T06:36:51Z",
//           text: "20/10/2023 06:36:51",
//         },
//         available: true,
//         Price: {
//           value: 0.975,
//           currency: "EUR",
//           text: "0.975 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-24T07:14:12Z",
//           text: "24/10/2023 07:14:12",
//         },
//         available: true,
//         Price: {
//           value: 1.799,
//           currency: "EUR",
//           text: "1.799 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-24T07:14:13Z",
//           text: "24/10/2023 07:14:13",
//         },
//         available: true,
//         Price: {
//           value: 1.859,
//           currency: "EUR",
//           text: "1.859 €",
//         },
//       },
//       {
//         id: 4,
//         name: "GPLc",
//         short_name: "GPLc",
//         picto: "LPG",
//         Update: {
//           value: "2023-05-26T13:58:58Z",
//           text: "26/05/2023 13:58:58",
//         },
//         available: true,
//         Price: {
//           value: 0.955,
//           currency: "EUR",
//           text: "0.955 €",
//         },
//       },
//     ],
//   },
//   {
//     id: 13400015,
//     Brand: "TotalEnergies",
//     name: "Station et Services des Paluds",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-24T11:26:06Z",
//           text: "24/10/2023 11:26:06",
//         },
//         available: true,
//         Price: {
//           value: 1.967,
//           currency: "EUR",
//           text: "1.967 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-24T11:26:07Z",
//           text: "24/10/2023 11:26:07",
//         },
//         available: true,
//         Price: {
//           value: 1.914,
//           currency: "EUR",
//           text: "1.914 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-24T11:26:07Z",
//           text: "24/10/2023 11:26:07",
//         },
//         available: true,
//         Price: {
//           value: 1.99,
//           currency: "EUR",
//           text: "1.99 €",
//         },
//       },
//     ],
//   },
//   {
//     id: 13400009,
//     Brand: "Casino",
//     name: "CASINO SUPERMARCHE",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-21T07:11:34Z",
//           text: "21/10/2023 07:11:34",
//         },
//         available: true,
//         Price: {
//           value: 1.929,
//           currency: "EUR",
//           text: "1.929 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-21T07:11:34Z",
//           text: "21/10/2023 07:11:34",
//         },
//         available: true,
//         Price: {
//           value: 1.819,
//           currency: "EUR",
//           text: "1.819 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-21T07:11:35Z",
//           text: "21/10/2023 07:11:35",
//         },
//         available: true,
//         Price: {
//           value: 1.899,
//           currency: "EUR",
//           text: "1.899 €",
//         },
//       },
//     ],
//   },
//   {
//     id: 13400014,
//     Brand: "TotalEnergies",
//     name: "RELAIS PIN VERT",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-23T21:00:00Z",
//           text: "23/10/2023 21:00:00",
//         },
//         available: true,
//         Price: {
//           value: 1.957,
//           currency: "EUR",
//           text: "1.957 €",
//         },
//       },
//       {
//         id: 3,
//         name: "Super Ethanol E85",
//         short_name: "E85",
//         picto: "E85",
//         Update: {
//           value: "2023-10-23T21:00:00Z",
//           text: "23/10/2023 21:00:00",
//         },
//         available: true,
//         Price: {
//           value: 0.994,
//           currency: "EUR",
//           text: "0.994 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-23T21:00:00Z",
//           text: "23/10/2023 21:00:00",
//         },
//         available: true,
//         Price: {
//           value: 1.904,
//           currency: "EUR",
//           text: "1.904 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-23T21:00:00Z",
//           text: "23/10/2023 21:00:00",
//         },
//         available: true,
//         Price: {
//           value: 1.99,
//           currency: "EUR",
//           text: "1.99 €",
//         },
//       },
//     ],
//   },
//   {
//     id: 13400007,
//     Brand: "Esso Express",
//     name: "ESSO LA DEMANDE",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-24T05:31:00Z",
//           text: "24/10/2023 05:31:00",
//         },
//         available: true,
//         Price: {
//           value: 1.889,
//           currency: "EUR",
//           text: "1.889 €",
//         },
//       },
//       {
//         id: 3,
//         name: "Super Ethanol E85",
//         short_name: "E85",
//         picto: "E85",
//         Update: {
//           value: "2023-10-24T05:31:00Z",
//           text: "24/10/2023 05:31:00",
//         },
//         available: true,
//         Price: {
//           value: 1.019,
//           currency: "EUR",
//           text: "1.019 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-24T05:31:00Z",
//           text: "24/10/2023 05:31:00",
//         },
//         available: true,
//         Price: {
//           value: 1.869,
//           currency: "EUR",
//           text: "1.869 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-24T05:31:00Z",
//           text: "24/10/2023 05:31:00",
//         },
//         available: true,
//         Price: {
//           value: 1.949,
//           currency: "EUR",
//           text: "1.949 €",
//         },
//       },
//     ],
//   },
//   {
//     id: 13400003,
//     Brand: "TotalEnergies",
//     name: "SARL STATION ET SCES CAMP",
//     Fuels: [
//       {
//         id: 1,
//         name: "Gazole",
//         short_name: "Gazole",
//         picto: "B7",
//         Update: {
//           value: "2023-10-21T07:18:47Z",
//           text: "21/10/2023 07:18:47",
//         },
//         available: true,
//         Price: {
//           value: 1.947,
//           currency: "EUR",
//           text: "1.947 €",
//         },
//       },
//       {
//         id: 3,
//         name: "Super Ethanol E85",
//         short_name: "E85",
//         picto: "E85",
//         Update: {
//           value: "2023-10-14T08:09:06Z",
//           text: "14/10/2023 08:09:06",
//         },
//         available: true,
//         Price: {
//           value: 0.994,
//           currency: "EUR",
//           text: "0.994 €",
//         },
//       },
//       {
//         id: 5,
//         name: "Super Sans Plomb 95 E10",
//         short_name: "SP95-E10",
//         picto: "E10",
//         Update: {
//           value: "2023-10-21T07:18:47Z",
//           text: "21/10/2023 07:18:47",
//         },
//         available: true,
//         Price: {
//           value: 1.892,
//           currency: "EUR",
//           text: "1.892 €",
//         },
//       },
//       {
//         id: 6,
//         name: "Super Sans Plomb 98",
//         short_name: "SP98",
//         picto: "E5",
//         Update: {
//           value: "2023-10-14T08:09:06Z",
//           text: "14/10/2023 08:09:06",
//         },
//         available: true,
//         Price: {
//           value: 1.99,
//           currency: "EUR",
//           text: "1.99 €",
//         },
//       },
//     ],
//   },
// ];

// const quantitiesEx = {
//   e85: 13,
//   sp95E10: 26,
//   sp98: 0,
// };

export function blendAndSort(stations, quantities) {
  const { e85, sp95E10, sp98 } = quantities;
  let sortedStations;

  function calculateTotalPrice(sp95E10Price, e85Price, sp98Price) {
    return sp95E10Price * sp95E10 + e85Price * e85 + sp98Price * sp98;
  }

  if (stations) {
    sortedStations = stations
      .filter((station) => station.Fuels.some((fuel) => fuel.id === 3))
      .map((station) => {
        const sp95E10Fuel = station.Fuels.filter((fuel) => fuel.id === 5);
        const e85Fuel = station.Fuels.filter((fuel) => fuel.id === 3);
        const sp98Fuel = station.Fuels.filter((fuel) => fuel.id === 6);

        const sp95E10Price =
          sp95E10Fuel.length > 0 ? sp95E10Fuel[0].Price.value : 0;
        const e85Price = e85Fuel.length > 0 ? e85Fuel[0].Price.value : 0;
        const sp98Price = sp98Fuel.length > 0 ? sp98Fuel[0].Price.value : 0;

        const totalPrice = calculateTotalPrice(
          sp95E10Price,
          e85Price,
          sp98Price
        );

        return {
          ...station,
          totalPrice,
        };
      });

    sortedStations.sort((a, b) => a.totalPrice - b.totalPrice);

    return sortedStations;
  }
}
